[debug] [2025-12-05T06:13:04.634Z] ----------------------------------------------------------------------
[debug] [2025-12-05T06:13:04.635Z] Command:       /usr/local/bin/node /usr/local/bin/firebase functions:shell
[debug] [2025-12-05T06:13:04.635Z] CLI Version:   14.27.0
[debug] [2025-12-05T06:13:04.635Z] Platform:      darwin
[debug] [2025-12-05T06:13:04.635Z] Node Version:  v22.13.1
[debug] [2025-12-05T06:13:04.636Z] Time:          Fri Dec 05 2025 15:13:04 GMT+0900 (Korean Standard Time)
[debug] [2025-12-05T06:13:04.636Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-12-05T06:13:04.721Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-12-05T06:13:04.721Z] > authorizing via signed-in user (sungmo0926@gmail.com)
[debug] [2025-12-05T06:13:04.721Z] [iam] checking project musive-1faba for permissions ["firebase.projects.get"]
[debug] [2025-12-05T06:13:04.722Z] Checked if tokens are valid: true, expires at: 1764917873357
[debug] [2025-12-05T06:13:04.722Z] Checked if tokens are valid: true, expires at: 1764917873357
[debug] [2025-12-05T06:13:04.722Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/musive-1faba:testIamPermissions [none]
[debug] [2025-12-05T06:13:04.722Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/musive-1faba:testIamPermissions x-goog-quota-user=projects/musive-1faba
[debug] [2025-12-05T06:13:04.722Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/musive-1faba:testIamPermissions {"permissions":["firebase.projects.get"]}
[debug] [2025-12-05T06:13:04.991Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/musive-1faba:testIamPermissions 200
[debug] [2025-12-05T06:13:04.991Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/musive-1faba:testIamPermissions {"permissions":["firebase.projects.get"]}
[debug] [2025-12-05T06:13:04.992Z] Emulator locator file path: /var/folders/2l/9nfqnsnj7657v3pc4n41_phh0000gn/T/hub-musive-1faba.json
[debug] [2025-12-05T06:13:05.004Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2025-12-05T06:13:05.010Z] defaultcredentials: writing to file /Users/seungmoku/.config/firebase/sungmo0926_gmail_com_application_default_credentials.json
[debug] [2025-12-05T06:13:05.011Z] DEBUG: Setting GAC to /Users/seungmoku/.config/firebase/sungmo0926_gmail_com_application_default_credentials.json
[debug] [2025-12-05T06:13:05.011Z] Checked if tokens are valid: true, expires at: 1764917873357
[debug] [2025-12-05T06:13:05.011Z] Checked if tokens are valid: true, expires at: 1764917873357
[debug] [2025-12-05T06:13:05.011Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/musive-1faba/adminSdkConfig [none]
[debug] [2025-12-05T06:13:05.441Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/musive-1faba/adminSdkConfig 200
[debug] [2025-12-05T06:13:05.442Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/musive-1faba/adminSdkConfig {"projectId":"musive-1faba","storageBucket":"musive-1faba.firebasestorage.app"}
[debug] [2025-12-05T06:13:05.450Z] [functions] Watching "/Users/seungmoku/Documents/GitHub/musive/apps/functions" for Cloud Functions...
[debug] [2025-12-05T06:13:05.452Z] Validating nodejs source
[debug] [2025-12-05T06:13:05.857Z] > [functions] package.json contents: {
  "name": "@repo/functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "24"
  },
  "main": "lib/index.js",
  "dependencies": {
    "cheerio": "^1.1.2",
    "dotenv": "^17.2.3",
    "firebase-admin": "^13.6.0",
    "firebase-functions": "^7.0.0",
    "nodemailer": "^7.0.11",
    "openai": "^6.10.0",
    "rss-parser": "^3.13.0",
    "xml2js": "^0.6.2"
  },
  "devDependencies": {
    "@types/cheerio": "^1.0.0",
    "@types/nodemailer": "^7.0.4",
    "@types/xml2js": "^0.4.14",
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.4.1",
    "typescript": "^5.7.3"
  },
  "private": true
}
[debug] [2025-12-05T06:13:05.857Z] Building nodejs source
[debug] [2025-12-05T06:13:05.857Z] Failed to find version of module node: reached end of search path /Users/seungmoku/Documents/GitHub/musive/apps/functions/node_modules
[warn] âš   functions: Your requested "node" version "24" doesn't match your global version "22". Using node@22 from host. 
[info] i  functions: Loaded environment variables from .env. 
[debug] [2025-12-05T06:13:05.859Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-12-05T06:13:05.862Z] Found firebase-functions binary at '/Users/seungmoku/Documents/GitHub/musive/apps/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8248

[info] [dotenv@17.2.3] injecting env (3) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

[error] (node:26068) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)

[debug] [2025-12-05T06:13:06.118Z] Got response from /__/functions.yaml {"endpoints":{"testCrawler":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"httpsTrigger":{},"entryPoint":"testCrawler"},"sendDailyMusicNews":{"availableMemoryMb":1024,"timeoutSeconds":540,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["asia-northeast3"],"labels":{},"scheduleTrigger":{"schedule":"0 7 * * *","retryConfig":{},"timeZone":"Asia/Seoul"},"entryPoint":"sendDailyMusicNews"}},"specVersion":"v1alpha1","requiredAPIs":[{"api":"cloudscheduler.googleapis.com","reason":"Needed for scheduled functions."}],"extensions":{}}
[debug] [2025-12-05T06:13:10.148Z] [functions] Loaded functions definitions from source: testCrawler, sendDailyMusicNews.
[debug] [2025-12-05T06:13:10.150Z] [functions[us-central1-testCrawler]] http function initialized (http://127.0.0.1:5000/musive-1faba/us-central1/testCrawler).
[debug] [2025-12-05T06:13:10.150Z] [functions[asia-northeast3-sendDailyMusicNews]] function ignored because the pubsub emulator does not exist or is not running.
[info] i  functions: Loaded functions: testCrawler, sendDailyMusicNews 
[warn] âš   functions: The following emulators are not running, calls to these services will affect production: firestore, database, pubsub, storage, eventarc, tasks 
[debug] [2025-12-05T06:13:43.274Z] shell:sendDailyMusicNews: trigger={"entryPoint":"sendDailyMusicNews","platform":"gcfv2","region":"asia-northeast3","name":"sendDailyMusicNews","id":"asia-northeast3-sendDailyMusicNews","codebase":"default","availableMemoryMb":1024,"labels":{"EVENTARC_CLOUD_EVENT_SOURCE":"run-emulated.googleapis.com/projects/musive-1faba/locations/asia-northeast3/services/sendDailyMusicNews"},"timeoutSeconds":540,"secretEnvironmentVariables":[],"eventTrigger":{"eventType":"pubsub","resource":""},"schedule":{"schedule":"0 7 * * *","timeZone":"Asia/Seoul","retryConfig":{}}}
[debug] [2025-12-05T06:13:43.275Z] shell:sendDailyMusicNews: opts={}, data={}
[info] i  functions: Loaded environment variables from .env. 
[debug] [2025-12-05T06:13:43.282Z] DEBUG: [worker-pool] addWorker(asia-northeast3-sendDailyMusicNews)
[debug] [2025-12-05T06:13:43.283Z] DEBUG: [worker-pool] Adding worker with key asia-northeast3-sendDailyMusicNews, total=1
[info] >  (node:26124) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead. {"user":"(node:26124) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.","metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"\u001b[90m> \u001b[39m (node:26124) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead."}}
[info] >  (Use `node --trace-deprecation ...` to show where the warning was created) {"user":"(Use `node --trace-deprecation ...` to show where the warning was created)","metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"\u001b[90m> \u001b[39m (Use `node --trace-deprecation ...` to show where the warning was created)"}}
[debug] [2025-12-05T06:13:43.775Z] DEBUG: [runtime-status] [26124] Resolved module firebase-admin {"declared":true,"installed":true,"version":"13.6.0","resolution":"/Users/seungmoku/Documents/GitHub/musive/node_modules/.pnpm/firebase-admin@13.6.0/node_modules/firebase-admin/lib/index.js"}
[debug] [2025-12-05T06:13:43.775Z] DEBUG: [runtime-status] [26124] Resolved module firebase-functions {"declared":true,"installed":true,"version":"7.0.1","resolution":"/Users/seungmoku/Documents/GitHub/musive/node_modules/.pnpm/firebase-functions@7.0.1_firebase-admin@13.6.0/node_modules/firebase-functions/lib/v2/index.js"}
[debug] [2025-12-05T06:13:43.775Z] DEBUG: [runtime-status] [26124] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}]
[debug] [2025-12-05T06:13:43.775Z] DEBUG: [runtime-status] [26124] Resolved module firebase-functions {"declared":true,"installed":true,"version":"7.0.1","resolution":"/Users/seungmoku/Documents/GitHub/musive/node_modules/.pnpm/firebase-functions@7.0.1_firebase-admin@13.6.0/node_modules/firebase-functions/lib/v2/index.js"}
[debug] [2025-12-05T06:13:43.775Z] DEBUG: [runtime-status] [26124] Detected firebase-functions v7+, skipping config helper.
[debug] [2025-12-05T06:13:43.776Z] DEBUG: [runtime-status] [26124] Resolved module firebase-functions {"declared":true,"installed":true,"version":"7.0.1","resolution":"/Users/seungmoku/Documents/GitHub/musive/node_modules/.pnpm/firebase-functions@7.0.1_firebase-admin@13.6.0/node_modules/firebase-functions/lib/v2/index.js"}
[debug] [2025-12-05T06:13:43.776Z] DEBUG: [runtime-status] [26124] Detected firebase-functions v7+, skipping legacy stubs.
[debug] [2025-12-05T06:13:43.776Z] DEBUG: [runtime-status] [26124] Resolved module firebase-admin {"declared":true,"installed":true,"version":"13.6.0","resolution":"/Users/seungmoku/Documents/GitHub/musive/node_modules/.pnpm/firebase-admin@13.6.0/node_modules/firebase-admin/lib/index.js"}
[debug] [2025-12-05T06:13:43.818Z] DEBUG: [runtime-status] [26124] Resolved module firebase-functions {"declared":true,"installed":true,"version":"7.0.1","resolution":"/Users/seungmoku/Documents/GitHub/musive/node_modules/.pnpm/firebase-functions@7.0.1_firebase-admin@13.6.0/node_modules/firebase-functions/lib/v2/index.js"}
[debug] [2025-12-05T06:13:43.939Z] DEBUG: [runtime-status] [26124] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"13.6.0","resolution":"/Users/seungmoku/Documents/GitHub/musive/node_modules/.pnpm/firebase-admin@13.6.0/node_modules/firebase-admin/lib/index.js"}}
[info] >  [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' } {"user":"[dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"\u001b[90m> \u001b[39m [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' }"}}
[debug] [2025-12-05T06:13:44.059Z] DEBUG: [runtime-status] [26124] initializeApp(DEFAULT) {"storageBucket":"musive-1faba.firebasestorage.app","projectId":"musive-1faba"}
[warn] âš   functions: The Cloud Firestore emulator is not running, so calls to Firestore will affect production. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"The Cloud Firestore emulator is not running, so calls to Firestore will affect production."}}
[debug] [2025-12-05T06:13:44.065Z] DEBUG: [runtime-status] [26124] Functions runtime initialized. {"cwd":"/Users/seungmoku/Documents/GitHub/musive/apps/functions","node_version":"22.13.1"}
[debug] [2025-12-05T06:13:44.065Z] DEBUG: [runtime-status] [26124] Listening to port: /var/folders/2l/9nfqnsnj7657v3pc4n41_phh0000gn/T/fire_emu_298f2335da3e519a.sock
[debug] [2025-12-05T06:13:44.098Z] DEBUG: [worker-asia-northeast3-sendDailyMusicNews-db63f19a-a67a-4e3e-836b-033e1d68137c]: IDLE
[info] >  {"severity":"INFO","message":"ë‰´ìŠ¤ë ˆí„° ì „ì†¡ ì‹œìž‘."} {"user":{"severity":"INFO","message":"ë‰´ìŠ¤ë ˆí„° ì „ì†¡ ì‹œìž‘."},"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"severity\":\"INFO\",\"message\":\"ë‰´ìŠ¤ë ˆí„° ì „ì†¡ ì‹œìž‘.\"}"}}
[warn] âš   External network resource requested!
   - URL: "https://www.billboard.com/feed/"
 - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"External network resource requested!\n   - URL: \"https://www.billboard.com/feed/\"\n - Be careful, this may be a production service."}}
[warn] âš   External network resource requested!
   - URL: "https://www.rollingstone.com/music/music-news/feed/"
 - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"External network resource requested!\n   - URL: \"https://www.rollingstone.com/music/music-news/feed/\"\n - Be careful, this may be a production service."}}
[warn] âš   External network resource requested!
   - URL: "https://www.nme.com/feed"
 - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"External network resource requested!\n   - URL: \"https://www.nme.com/feed\"\n - Be careful, this may be a production service."}}
[warn] âš   External network resource requested!
   - URL: "https://pitchfork.com/feed/feed-news/rss"
 - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"External network resource requested!\n   - URL: \"https://pitchfork.com/feed/feed-news/rss\"\n - Be careful, this may be a production service."}}
[warn] âš   External network resource requested!
   - URL: "https://variety.com/c/music/feed/"
 - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"External network resource requested!\n   - URL: \"https://variety.com/c/music/feed/\"\n - Be careful, this may be a production service."}}
[warn] âš   Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  {"severity":"INFO","message":"âœ… ì „ì†¡ ì™„ë£Œ: 1ëª…"} {"user":{"severity":"INFO","message":"âœ… ì „ì†¡ ì™„ë£Œ: 1ëª…"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"asia-northeast3-sendDailyMusicNews"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"severity\":\"INFO\",\"message\":\"âœ… ì „ì†¡ ì™„ë£Œ: 1ëª…\"}"}}
[debug] [2025-12-05T06:16:25.435Z] DEBUG: File /Users/seungmoku/Documents/GitHub/musive/apps/functions/src/index.ts changed, reloading triggers
[debug] [2025-12-05T06:16:26.438Z] Validating nodejs source
[debug] [2025-12-05T06:16:26.923Z] > [functions] package.json contents: {
  "name": "@repo/functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "24"
  },
  "main": "lib/index.js",
  "dependencies": {
    "cheerio": "^1.1.2",
    "dotenv": "^17.2.3",
    "firebase-admin": "^13.6.0",
    "firebase-functions": "^7.0.0",
    "nodemailer": "^7.0.11",
    "openai": "^6.10.0",
    "rss-parser": "^3.13.0",
    "xml2js": "^0.6.2"
  },
  "devDependencies": {
    "@types/cheerio": "^1.0.0",
    "@types/nodemailer": "^7.0.4",
    "@types/xml2js": "^0.4.14",
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.4.1",
    "typescript": "^5.7.3"
  },
  "private": true
}
[debug] [2025-12-05T06:16:26.923Z] Building nodejs source
[debug] [2025-12-05T06:16:26.923Z] Failed to find version of module node: reached end of search path /Users/seungmoku/Documents/GitHub/musive/apps/functions/node_modules
[warn] âš   functions: Your requested "node" version "24" doesn't match your global version "22". Using node@22 from host. 
[info] i  functions: Loaded environment variables from .env. 
[debug] [2025-12-05T06:16:26.925Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-12-05T06:16:26.926Z] Found firebase-functions binary at '/Users/seungmoku/Documents/GitHub/musive/apps/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8194

[info] [dotenv@17.2.3] injecting env (3) from .env -- tip: ðŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops

[error] (node:26686) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)

[debug] [2025-12-05T06:16:27.483Z] Got response from /__/functions.yaml {"endpoints":{"testCrawler":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"httpsTrigger":{},"entryPoint":"testCrawler"},"sendDailyMusicNews":{"availableMemoryMb":1024,"timeoutSeconds":540,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["asia-northeast3"],"labels":{},"scheduleTrigger":{"schedule":"0 7 * * *","retryConfig":{},"timeZone":"Asia/Seoul"},"entryPoint":"sendDailyMusicNews"}},"specVersion":"v1alpha1","requiredAPIs":[{"api":"cloudscheduler.googleapis.com","reason":"Needed for scheduled functions."}],"extensions":{}}
[debug] [2025-12-05T06:16:31.497Z] [functions] Loaded functions definitions from source: testCrawler, sendDailyMusicNews.
[debug] [2025-12-05T06:16:31.497Z] DEBUG: [worker-pool] Shutting down IDLE worker (asia-northeast3-sendDailyMusicNews)
[debug] [2025-12-05T06:16:31.497Z] DEBUG: [worker-asia-northeast3-sendDailyMusicNews-db63f19a-a67a-4e3e-836b-033e1d68137c]: FINISHING
[debug] [2025-12-05T06:16:31.505Z] DEBUG: [worker-asia-northeast3-sendDailyMusicNews-db63f19a-a67a-4e3e-836b-033e1d68137c]: exited
[debug] [2025-12-05T06:16:31.505Z] DEBUG: [worker-asia-northeast3-sendDailyMusicNews-db63f19a-a67a-4e3e-836b-033e1d68137c]: FINISHED
